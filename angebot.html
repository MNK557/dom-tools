<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DomAssist Dienstleistungsvertrag</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            background: #f8fafc;
            padding: 20px;
            line-height: 1.8;
            color: #1e293b;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header-subtitle {
            font-size: 16px;
            opacity: 0.9;
        }

        .contract-number {
            background: rgba(255,255,255,0.2);
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 14px;
        }

        /* Content */
        .content {
            padding: 50px;
        }

        .page {
            page-break-after: always;
            min-height: 800px;
        }

        .page:last-of-type {
            page-break-after: auto;
        }

        /* Parties Section */
        .parties {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 40px;
        }

        .party {
            margin-bottom: 25px;
        }

        .party:last-child {
            margin-bottom: 0;
        }

        .party-label {
            font-weight: bold;
            font-size: 14px;
            color: #64748b;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .party-details {
            font-size: 16px;
            line-height: 1.6;
        }

        .party-name {
            font-weight: bold;
            font-size: 18px;
            color: #1e293b;
            margin-bottom: 5px;
        }

        /* Package Highlight */
        .package-highlight {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-left: 4px solid #667eea;
            padding: 25px;
            margin: 30px 0;
            border-radius: 8px;
        }

        .package-name {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
        }

        .package-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .detail-label {
            font-weight: 600;
            color: #64748b;
        }

        .detail-value {
            font-weight: bold;
            color: #1e293b;
        }

        /* Paragraphs */
        .paragraph {
            margin-bottom: 30px;
        }

        .paragraph h2 {
            font-size: 18px;
            color: #1e293b;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .paragraph p {
            margin-bottom: 12px;
            text-align: justify;
        }

        .paragraph ul, .paragraph ol {
            margin-left: 25px;
            margin-bottom: 12px;
        }

        .paragraph li {
            margin-bottom: 8px;
        }

        /* Services List */
        .services-list {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .services-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .services-list li:last-child {
            border-bottom: none;
        }

        /* Price Table */
        .price-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }

        .price-table th,
        .price-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .price-table th {
            background: #f1f5f9;
            font-weight: bold;
            color: #1e293b;
        }

        .price-table .total-row {
            background: #f8fafc;
            font-weight: bold;
            font-size: 18px;
        }

        .price-table .price-value {
            text-align: right;
            font-weight: bold;
        }

        /* Info Boxes */
        .info-box {
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        /* Acceptance Section */
        .acceptance-section {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0e7ff 100%);
            border: 3px solid #667eea;
            border-radius: 16px;
            padding: 40px;
            margin: 50px 0;
        }

        .acceptance-section h2 {
            color: #667eea;
            margin-bottom: 25px;
            font-size: 24px;
            text-align: center;
        }

        .checkbox-group {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .checkbox-item {
            display: flex;
            align-items: start;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .checkbox-item:hover {
            background: #f8fafc;
        }

        .checkbox-item input[type="checkbox"] {
            width: 24px;
            height: 24px;
            min-width: 24px;
            margin-top: 3px;
            cursor: pointer;
            accent-color: #667eea;
        }

        .checkbox-label {
            flex: 1;
            cursor: pointer;
            line-height: 1.6;
        }

        .checkbox-label strong {
            color: #1e293b;
        }

        /* Payment Options */
        .payment-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .payment-option {
            border: 3px solid #e2e8f0;
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
        }

        .payment-option:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .payment-option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
        }

        .payment-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .payment-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .payment-name {
            font-size: 18px;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 10px;
        }

        .payment-desc {
            font-size: 14px;
            color: #64748b;
        }

        /* Buttons */
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            flex: 1;
            padding: 18px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(16, 185, 129, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #94a3b8;
        }

        .btn-secondary {
            background: white;
            color: #334155;
            border: 2px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #f8fafc;
        }

        /* Footer */
        .footer {
            background: #1e293b;
            color: white;
            padding: 30px;
            text-align: center;
            font-size: 13px;
        }

        .footer p {
            margin: 5px 0;
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 50px;
        }

        .loading-spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .acceptance-section,
            .button-group {
                display: none;
            }

            .page {
                page-break-after: always;
            }

            .content {
                padding: 30px;
            }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .header {
                padding: 25px 20px;
            }

            .header h1 {
                font-size: 22px;
            }

            .header-subtitle {
                font-size: 14px;
            }

            .contract-number {
                font-size: 12px;
                padding: 6px 15px;
            }

            .content {
                padding: 25px 20px;
            }

            .parties {
                padding: 20px;
            }

            .party-name {
                font-size: 16px;
            }

            .party-details {
                font-size: 14px;
            }

            .package-highlight {
                padding: 20px;
            }

            .package-name {
                font-size: 20px;
            }

            .package-details {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .detail-item {
                flex-direction: column;
                gap: 5px;
            }

            .paragraph h2 {
                font-size: 16px;
            }

            .paragraph p,
            .paragraph li {
                font-size: 14px;
                text-align: left;
            }

            .price-table {
                font-size: 14px;
            }

            .price-table th,
            .price-table td {
                padding: 10px 8px;
            }

            .price-table .total-row {
                font-size: 16px;
            }

            .acceptance-section {
                padding: 25px 20px;
                margin: 30px 0;
            }

            .acceptance-section h2 {
                font-size: 20px;
            }

            .checkbox-group {
                padding: 15px;
            }

            .checkbox-item {
                padding: 12px;
                gap: 10px;
            }

            .checkbox-item input[type="checkbox"] {
                width: 20px;
                height: 20px;
                min-width: 20px;
            }

            .checkbox-label {
                font-size: 14px;
            }

            .payment-options {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .payment-option {
                padding: 20px;
            }

            .payment-icon {
                font-size: 36px;
            }

            .payment-name {
                font-size: 16px;
            }

            .payment-desc {
                font-size: 13px;
            }

            .button-group {
                flex-direction: column;
                gap: 10px;
            }

            .btn {
                padding: 15px 20px;
                font-size: 15px;
            }

            .info-box,
            .warning-box {
                padding: 15px;
                font-size: 14px;
            }

            .services-list {
                padding: 15px;
            }

            .services-list li {
                font-size: 14px;
            }

            .page {
                min-height: auto;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 20px;
            }

            .content {
                padding: 20px 15px;
            }

            .package-name {
                font-size: 18px;
            }

            .paragraph h2 {
                font-size: 15px;
            }

            .acceptance-section h2 {
                font-size: 18px;
            }

            .btn {
                padding: 14px 18px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üìã Dienstleistungsvertrag</h1>
            <div class="header-subtitle">Entwicklung & Betrieb eines digitalen Assistenten</div>
            <div class="contract-number" id="contract-number">Wird geladen...</div>
        </div>

        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <p>Vertragsdaten werden geladen...</p>
        </div>

        <!-- Content (wird nach dem Laden angezeigt) -->
        <div id="contract-content" style="display: none;">
            <div class="content">
                
                <!-- PAGE 1: Vertragsparteien & Leistung -->
                <div class="page">
                    
                    <!-- Vertragsparteien -->
                    <div class="parties">
                        <div class="party">
                            <div class="party-label">Auftragnehmer</div>
                            <div class="party-details">
                                <div class="party-name">DomAssist Consulting (in Gr√ºndung)</div>
                                <div>Inhaber: Dominik Poletek</div>
                                <div>Am Elsenbruch 3, 12247 Berlin</div>
                                <div>E-Mail: dpo@domassist.de</div>
                            </div>
                        </div>
                        <div class="party">
                            <div class="party-label">Auftraggeber</div>
                            <div class="party-details">
                                <div class="party-name" id="customer-name">Wird geladen...</div>
                                <div id="customer-details">Kundendaten werden geladen...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Package Highlight -->
                    <div class="package-highlight">
                        <div class="package-name" id="package-name">BUSINESS PAKET</div>
                        <div class="package-details">
                            <div class="detail-item">
                                <span class="detail-label">Vertragsnummer:</span>
                                <span class="detail-value" id="detail-mid">---</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Vertragsdatum:</span>
                                <span class="detail-value" id="detail-date">---</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Laufzeit:</span>
                                <span class="detail-value" id="detail-laufzeit">12 Monate</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Ihr Berater:</span>
                                <span class="detail-value" id="detail-vertreter">---</span>
                            </div>
                        </div>
                    </div>

                    <!-- ¬ß1 Vertragsgegenstand -->
                    <div class="paragraph">
                        <h2>¬ß1 Vertragsgegenstand</h2>
                        <p>
                            Der Auftragnehmer verpflichtet sich zur Entwicklung, Implementierung und zum Betrieb eines individuell konfigurierten digitalen Assistenten (nachfolgend "System") f√ºr den Auftraggeber. Das System dient der automatisierten Bearbeitung von Kundenanfragen √ºber verschiedene Kommunikationskan√§le.
                        </p>
                        <p>
                            Dieser Vertrag regelt die Rechte und Pflichten beider Vertragsparteien im Rahmen der Entwicklung, Implementierung, des Betriebs und der Wartung des Systems.
                        </p>
                    </div>

                    <!-- ¬ß2 Leistungsumfang -->
                    <div class="paragraph">
                        <h2>¬ß2 Leistungsumfang</h2>
                        <p>
                            Der Auftragnehmer erbringt folgende Leistungen im Rahmen des gew√§hlten Pakets <strong id="contract-package">BUSINESS</strong>:
                        </p>
                        <ul class="services-list" id="services-list">
                            <!-- Wird dynamisch gef√ºllt -->
                        </ul>
                        
                        <p style="margin-top: 20px;">
                            <strong>2.1 Einrichtungsphase (Setup):</strong> Die Einrichtung umfasst die Analyse der Kundenanforderungen, Konfiguration des Systems, Integration in bestehende Systeme (soweit technisch m√∂glich), Schulung des Auftraggebers und Testphase.
                        </p>
                        <p>
                            <strong>2.2 Betriebsphase:</strong> Nach erfolgreichem Abschluss der Einrichtungsphase √ºbernimmt der Auftragnehmer den laufenden Betrieb, die Wartung und Optimierung des Systems.
                        </p>
                        <p>
                            <strong>2.3 Support:</strong> Der Auftragnehmer bietet Support per E-Mail und Telefon w√§hrend der Gesch√§ftszeiten (Mo-Fr, 9-17 Uhr). Premium-Support mit erweiterten Zeiten kann gegen Aufpreis vereinbart werden.
                        </p>
                    </div>

                    <!-- ¬ß3 Preise & Zahlungsbedingungen -->
                    <div class="paragraph">
                        <h2>¬ß3 Preise und Zahlungsbedingungen</h2>
                        <p>
                            F√ºr die vertraglich vereinbarten Leistungen gelten folgende Preise (alle Preise netto zzgl. gesetzlicher Mehrwertsteuer):
                        </p>
                        
                        <table class="price-table">
                            <thead>
                                <tr>
                                    <th>Position</th>
                                    <th>Beschreibung</th>
                                    <th class="price-value">Netto</th>
                                    <th class="price-value">Brutto</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Einrichtungsgeb√ºhr</td>
                                    <td>Einmalige Setup- und Konfigurationsgeb√ºhr</td>
                                    <td class="price-value" id="price-setup-netto">799‚Ç¨</td>
                                    <td class="price-value" id="price-setup-brutto">951‚Ç¨</td>
                                </tr>
                                <tr>
                                    <td>Monatliche Servicegeb√ºhr</td>
                                    <td>Betrieb, Wartung, Support und Optimierung</td>
                                    <td class="price-value" id="price-monthly-netto">149‚Ç¨</td>
                                    <td class="price-value" id="price-monthly-brutto">177‚Ç¨</td>
                                </tr>
                                <tr class="total-row">
                                    <td colspan="2">Gesamtkosten erstes Jahr</td>
                                    <td class="price-value" id="price-total-netto">2.587‚Ç¨</td>
                                    <td class="price-value" id="price-total-brutto">3.078‚Ç¨</td>
                                </tr>
                            </tbody>
                        </table>

                        <p>
                            <strong>3.1 F√§lligkeit:</strong> Die Einrichtungsgeb√ºhr ist mit Vertragsschluss zur Zahlung f√§llig. Die monatliche Servicegeb√ºhr ist jeweils am ersten Werktag des Monats im Voraus f√§llig.
                        </p>
                        <p>
                            <strong>3.2 Zahlungsweise:</strong> Die Zahlung erfolgt wahlweise per SEPA-Lastschrift, √úberweisung, Kreditkarte oder Barzahlung. Bei Zahlung per SEPA-Lastschrift erteilt der Auftraggeber ein entsprechendes Mandat.
                        </p>
                        <p>
                            <strong>3.3 Verzug:</strong> Bei Zahlungsverzug ist der Auftragnehmer berechtigt, Verzugszinsen in H√∂he von 9 Prozentpunkten √ºber dem Basiszinssatz (bei Verbrauchern: 5 Prozentpunkte) zu berechnen.
                        </p>
                    </div>

                </div>

                <!-- PAGE 2: Laufzeit & Pflichten (gek√ºrzt f√ºr Mobile) -->
                <div class="page">
                    
                    <!-- ¬ß4 Laufzeit & K√ºndigung -->
                    <div class="paragraph">
                        <h2>¬ß4 Vertragslaufzeit und K√ºndigung</h2>
                        <p>
                            <strong>4.1 Mindestvertragslaufzeit:</strong> Der Vertrag wird f√ºr eine Mindestlaufzeit von <strong id="contract-duration">12 Monaten</strong> ab Inbetriebnahme des Systems geschlossen.
                        </p>
                        <p>
                            <strong>4.2 Verl√§ngerung:</strong> Der Vertrag verl√§ngert sich nach Ablauf der Mindestvertragslaufzeit automatisch um jeweils weitere 12 Monate, sofern er nicht mit einer Frist von 3 Monaten zum Ende der jeweiligen Laufzeit gek√ºndigt wird.
                        </p>
                        <p>
                            <strong>4.3 Ordentliche K√ºndigung:</strong> Beide Parteien k√∂nnen den Vertrag nach Ablauf der Mindestvertragslaufzeit mit einer Frist von 3 Monaten zum Monatsende in Textform (E-Mail ausreichend) k√ºndigen.
                        </p>
                    </div>

                    <!-- ¬ß5 Pflichten des Auftraggebers -->
                    <div class="paragraph">
                        <h2>¬ß5 Mitwirkungspflichten des Auftraggebers</h2>
                        <p>
                            Der Auftraggeber verpflichtet sich zur Mitwirkung bei der Vertragserf√ºllung, insbesondere zur rechtzeitigen Bereitstellung aller erforderlichen Informationen, Zug√§nge und Materialien.
                        </p>
                    </div>

                    <!-- ¬ß6 Gew√§hrleistung & Haftung -->
                    <div class="paragraph">
                        <h2>¬ß6 Gew√§hrleistung und Haftung</h2>
                        <p>
                            <strong>6.1 Verf√ºgbarkeit:</strong> Der Auftragnehmer strebt eine Verf√ºgbarkeit des Systems von 99% im Jahresmittel an.
                        </p>
                        <p>
                            <strong>6.2 Haftungsbeschr√§nkung:</strong> Bei leichter Fahrl√§ssigkeit haftet der Auftragnehmer nur bei Verletzung wesentlicher Vertragspflichten und begrenzt auf den vorhersehbaren, vertragstypischen Schaden.
                        </p>
                    </div>

                    <!-- ¬ß7 Datenschutz -->
                    <div class="paragraph">
                        <h2>¬ß7 Datenschutz</h2>
                        <p>
                            <strong>7.1 Auftragsverarbeitung:</strong> Die Verarbeitung personenbezogener Daten erfolgt gem√§√ü Art. 28 DSGVO. Die Einzelheiten werden in einem separaten Auftragsverarbeitungsvertrag geregelt.
                        </p>
                        <p>
                            <strong>7.2 Datenverarbeitung in der EU:</strong> Die Verarbeitung personenbezogener Daten erfolgt ausschlie√ülich auf Servern innerhalb der Europ√§ischen Union.
                        </p>
                    </div>

                    <!-- ¬ß8 Widerrufsrecht -->
                    <div class="paragraph">
                        <h2>¬ß8 Widerrufsrecht und Widerrufsausschluss</h2>
                        
                        <div class="info-box">
                            <p><strong>F√ºr Unternehmer (B2B):</strong></p>
                            <p>Dieses Widerrufsrecht besteht nicht, wenn der Auftraggeber Unternehmer im Sinne des ¬ß 14 BGB ist.</p>
                        </div>

                        <div class="warning-box">
                            <p><strong>F√ºr Verbraucher (B2C):</strong></p>
                            <p>
                                Das Widerrufsrecht erlischt gem√§√ü ¬ß 356 Abs. 4 BGB bei Dienstleistungen, wenn der Unternehmer die Dienstleistung vollst√§ndig erbracht hat und mit der Ausf√ºhrung erst begonnen hat, nachdem der Verbraucher seine ausdr√ºckliche Zustimmung gegeben und seine Kenntnis davon best√§tigt hat, dass er sein Widerrufsrecht verliert.
                            </p>
                            <p style="margin-top: 15px;">
                                Dar√ºber hinaus besteht kein Widerrufsrecht bei individuell konfigurierten Dienstleistungen gem√§√ü ¬ß 312g Abs. 2 Nr. 1 BGB.
                            </p>
                        </div>
                    </div>

                    <!-- ¬ß9 Schlussbestimmungen -->
                    <div class="paragraph">
                        <h2>¬ß9 Schlussbestimmungen</h2>
                        <p>
                            <strong>9.1 Anwendbares Recht:</strong> F√ºr diesen Vertrag gilt ausschlie√ülich das Recht der Bundesrepublik Deutschland.
                        </p>
                        <p>
                            <strong>9.2 Gerichtsstand:</strong> Ist der Auftraggeber Kaufmann, ist ausschlie√ülicher Gerichtsstand Berlin.
                        </p>
                    </div>

                </div>

                <!-- PAGE 3: Vertragsannahme -->
                <div class="page">
                    
                    <!-- Vertragsannahme -->
                    <div class="acceptance-section">
                        <h2>‚úçÔ∏è Vertragsannahme</h2>
                        
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="accept-terms" required>
                                <label for="accept-terms" class="checkbox-label">
                                    <strong>Ich habe die Vertragsbedingungen gelesen und akzeptiere sie vollumf√§nglich.</strong> Mir ist bewusst, dass dieser Vertrag rechtlich bindend ist.
                                </label>
                            </div>

                            <div class="checkbox-item">
                                <input type="checkbox" id="accept-individual" required>
                                <label for="accept-individual" class="checkbox-label">
                                    <strong>Ich bin dar√ºber informiert,</strong> dass es sich um eine individuell auf meine Bed√ºrfnisse zugeschnittene Dienstleistung handelt und stimme zu, dass mit der Umsetzung sofort nach Vertragsschluss begonnen wird.
                                </label>
                            </div>

                            <div class="checkbox-item">
                                <input type="checkbox" id="accept-withdrawal" required>
                                <label for="accept-withdrawal" class="checkbox-label">
                                    <strong>Ich best√§tige,</strong> dass ich zur Kenntnis genommen habe, dass aufgrund der Individualit√§t der Leistung sowie durch den sofortigen Beginn der Vertragserf√ºllung ein Widerrufsrecht ausgeschlossen ist (¬ß8 dieses Vertrages).
                                </label>
                            </div>

                            <div class="checkbox-item">
                                <input type="checkbox" id="accept-privacy" required>
                                <label for="accept-privacy" class="checkbox-label">
                                    <strong>Ich habe die <a href="http://46.224.28.22/datenschutz.html" target="_blank">Datenschutzerkl√§rung</a> zur Kenntnis genommen</strong> und bin mit der Verarbeitung meiner personenbezogenen Daten einverstanden.
                                </label>
                            </div>
                        </div>

                        <h3 style="text-align: center; margin-top: 40px; margin-bottom: 20px; color: #1e293b;">
                            Bitte w√§hlen Sie Ihre Zahlungsmethode: *
                        </h3>

                        <div class="payment-options">
                            <label class="payment-option" for="payment-stripe">
                                <input type="radio" name="payment" id="payment-stripe" value="stripe">
                                <div class="payment-icon">üí≥</div>
                                <div class="payment-name">Online bezahlen</div>
                                <div class="payment-desc">Kreditkarte, SEPA, PayPal via Stripe</div>
                            </label>

                            <label class="payment-option" for="payment-invoice">
                                <input type="radio" name="payment" id="payment-invoice" value="invoice">
                                <div class="payment-icon">üìÑ</div>
                                <div class="payment-name">Rechnung</div>
                                <div class="payment-desc">√úberweisung (14 Tage Zahlungsziel)</div>
                            </label>

                            <label class="payment-option" for="payment-cash">
                                <input type="radio" name="payment" id="payment-cash" value="cash">
                                <div class="payment-icon">üí∂</div>
                                <div class="payment-name">Barzahlung</div>
                                <div class="payment-desc">Pers√∂nliche Zahlung vor Ort</div>
                            </label>
                        </div>

                        <div class="info-box" style="margin-top: 20px;">
                            <p style="margin: 0;">
                                <strong>üìÖ Vertragsdatum:</strong> <span id="signature-date">---</span><br>
                                <strong>üîê Digitale Signatur:</strong> Durch Klick auf "Verbindlich bestellen" wird dieser Vertrag rechtskr√§ftig geschlossen.
                            </p>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-secondary" onclick="window.print()">
                                üìÑ Vertrag als PDF speichern
                            </button>
                            <button class="btn btn-primary" id="btn-submit" disabled>
                                ‚úÖ Verbindlich bestellen
                            </button>
                        </div>
                    </div>

                </div>

            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p><strong>DomAssist Consulting (in Gr√ºndung)</strong> | Inhaber: Dominik Poletek</p>
            <p>Am Elsenbruch 3, 12247 Berlin</p>
            <p>E-Mail: dpo@domassist.de | Web: www.domassist.de</p>
            <p style="margin-top: 15px; font-size: 11px; opacity: 0.8;">
                Dieser Vertrag wurde elektronisch erstellt und ist ohne Unterschrift g√ºltig.
            </p>
        </div>

    </div>

    <script>
        // CONSTANTS
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwt2mHl3JFbAIUOAzm-FMkiVKExBXFzT9DJZ0R6hU8XF-xxgjX0OOOpGIPIPVyEBhJE/exec';
        
        const PACKAGE_SERVICES = {
            starter: [
                'WhatsApp-Assistent verf√ºgbar 24/7',
                'Automatische Beantwortung von Kundenanfragen',
                'Verarbeitung von bis zu 100 Anfragen pro Monat',
                'Kalenderintegration (Google/Outlook)',
                'Automatische Datenerfassung',
                'E-Mail-Benachrichtigungen bei wichtigen Anfragen',
                'Basis-Support per E-Mail (Mo-Fr, 9-17 Uhr)'
            ],
            business: [
                'Telefon-Assistent verf√ºgbar 24/7 f√ºr Anrufannahme',
                'WhatsApp-Assistent verf√ºgbar 24/7',
                'Automatische Terminbuchung in Ihrem Kalender',
                'Verarbeitung von bis zu 500 Anfragen pro Monat',
                'Kalenderintegration (Google/Outlook/Microsoft 365)',
                'Intelligente Lead-Qualifizierung',
                'CRM-Integration (Standard-Systeme)',
                'Automatische Datenerfassung und -strukturierung',
                'E-Mail- und SMS-Benachrichtigungen',
                'Priority Support per E-Mail und Telefon (Mo-Fr, 9-18 Uhr)',
                'Monatliche Performance-Reports'
            ],
            enterprise: [
                'Multi-Channel-Assistent (Telefon, WhatsApp, Web, Social Media)',
                'Unbegrenzte Anzahl von Anfragen',
                'Automatische Terminbuchung mit Konfliktmanagement',
                'Vollst√§ndige CRM-Integration (auch Custom-Systeme)',
                'Individuelle Workflow-Automatisierungen',
                'API-Zugang f√ºr eigene Integrationen',
                'Team-Management mit Rollenverteilung',
                'Advanced Analytics und Custom Reports',
                'Premium Lead-Qualifizierung mit Scoring',
                'Dedizierte Infrastruktur',
                'Priority Support 24/7 per E-Mail, Telefon und Chat',
                'Dedizierter Account Manager',
                'Monatliche Strategie-Calls und Optimierung'
            ]
        };

        // Load data from localStorage
        function loadContractData() {
            const urlParams = new URLSearchParams(window.location.search);
            const mid = urlParams.get('mid');

            if (!mid) {
                alert('Keine Vertragsnummer (MID) angegeben. Bitte verwenden Sie: vertrag.html?mid=MID-...');
                return false;
            }

            const localData = localStorage.getItem('currentCalculation');
            if (!localData) {
                alert('Keine Kalkulationsdaten gefunden. Bitte erstellen Sie zuerst ein Angebot.');
                return false;
            }

            const data = JSON.parse(localData);
            if (data.mid !== mid) {
                alert('Vertragsdaten nicht gefunden f√ºr MID: ' + mid);
                return false;
            }

            displayContract(data);
            return true;
        }

        function displayContract(data) {
            console.log('üìÑ Lade Vertrag f√ºr MID:', data.mid);

            // Hide loading, show content
            document.getElementById('loading').style.display = 'none';
            document.getElementById('contract-content').style.display = 'block';

            // Contract number
            document.getElementById('contract-number').textContent = data.mid;
            document.getElementById('detail-mid').textContent = data.mid;

            // Date
            const today = new Date().toLocaleDateString('de-DE', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            document.getElementById('detail-date').textContent = today;
            document.getElementById('signature-date').textContent = today;

            // Customer
            document.getElementById('customer-name').textContent = data.kundenname;
            document.getElementById('customer-details').innerHTML = `
                <div>${data.kundenEmail ? 'E-Mail: ' + data.kundenEmail : ''}</div>
                <div>Vertragsnummer: ${data.mid}</div>
            `;

            // Package
            const paketName = data.paketName || data.paket.toUpperCase();
            document.getElementById('package-name').textContent = paketName + ' PAKET';
            document.getElementById('contract-package').textContent = paketName;
            document.getElementById('detail-laufzeit').textContent = `${data.laufzeit} Monate`;
            document.getElementById('detail-vertreter').textContent = data.vertreter;
            document.getElementById('contract-duration').textContent = `${data.laufzeit} Monaten`;

            // Services
            const services = PACKAGE_SERVICES[data.paket] || PACKAGE_SERVICES.business;
            const servicesList = document.getElementById('services-list');
            servicesList.innerHTML = services.map(s => `<li>${s}</li>`).join('');

            // Prices
            const netto = {
                setup: data.setupFinal,
                monthly: data.monatlichFinal,
                year1: data.setupFinal + (data.monatlichFinal * data.laufzeit)
            };

            const brutto = {
                setup: Math.round(netto.setup * 1.19),
                monthly: Math.round(netto.monthly * 1.19),
                year1: Math.round(netto.year1 * 1.19)
            };

            document.getElementById('price-setup-netto').textContent = `${netto.setup.toLocaleString('de-DE')}‚Ç¨`;
            document.getElementById('price-setup-brutto').textContent = `${brutto.setup.toLocaleString('de-DE')}‚Ç¨`;
            document.getElementById('price-monthly-netto').textContent = `${netto.monthly.toLocaleString('de-DE')}‚Ç¨`;
            document.getElementById('price-monthly-brutto').textContent = `${brutto.monthly.toLocaleString('de-DE')}‚Ç¨`;
            document.getElementById('price-total-netto').textContent = `${netto.year1.toLocaleString('de-DE')}‚Ç¨`;
            document.getElementById('price-total-brutto').textContent = `${brutto.year1.toLocaleString('de-DE')}‚Ç¨`;

            // Store for payment
            window.contractData = {
                mid: data.mid,
                kunde: data.kundenname,
                kundenEmail: data.kundenEmail || '',
                setupNetto: netto.setup,
                setupBrutto: brutto.setup,
                monthlyNetto: netto.monthly,
                monthlyBrutto: brutto.monthly,
                laufzeit: data.laufzeit,
                paket: data.paket,
                paketName: paketName
            };

            console.log('‚úÖ Vertrag geladen:', window.contractData);
        }

        // Validation - alle Checkboxen UND Zahlungsmethode m√ºssen gew√§hlt sein
        function validateForm() {
            const allCheckboxesChecked = 
                document.getElementById('accept-terms').checked &&
                document.getElementById('accept-individual').checked &&
                document.getElementById('accept-withdrawal').checked &&
                document.getElementById('accept-privacy').checked;

            const paymentSelected = document.querySelector('input[name="payment"]:checked');

            const isValid = allCheckboxesChecked && paymentSelected;

            document.getElementById('btn-submit').disabled = !isValid;

            console.log('Validation:', {
                checkboxes: allCheckboxesChecked,
                payment: !!paymentSelected,
                isValid: isValid
            });
        }

        // Payment option selection
        function selectPaymentOption(option) {
            document.querySelectorAll('.payment-option').forEach(el => {
                el.classList.remove('selected');
            });
            option.classList.add('selected');
            validateForm();
        }

        // Submit contract
        async function submitContract() {
            const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
            
            const paymentNames = {
                'stripe': 'Online (Stripe)',
                'invoice': 'Rechnung',
                'cash': 'Barzahlung'
            };

            const confirmText = `Sind Sie sicher, dass Sie diesen Vertrag verbindlich abschlie√üen m√∂chten?\n\n` +
                `Kunde: ${window.contractData.kunde}\n` +
                `Paket: ${window.contractData.paketName}\n` +
                `Setup: ${window.contractData.setupBrutto}‚Ç¨ (brutto)\n` +
                `Monatlich: ${window.contractData.monthlyBrutto}‚Ç¨ (brutto)\n` +
                `Zahlungsweise: ${paymentNames[paymentMethod]}`;

            if (!confirm(confirmText)) {
                return;
            }

            // Button deaktivieren
            const btn = document.getElementById('btn-submit');
            btn.disabled = true;
            btn.textContent = '‚è≥ Wird verarbeitet...';

            try {
                // Vertragsdaten an Apps Script senden
                const contractData = {
                    action: 'saveContractAcceptance',
                    mid: window.contractData.mid,
                    kundenname: window.contractData.kunde,
                    kundenEmail: window.contractData.kundenEmail,
                    paketName: window.contractData.paketName,
                    laufzeit: window.contractData.laufzeit,
                    setupBrutto: window.contractData.setupBrutto,
                    monthlyBrutto: window.contractData.monthlyBrutto,
                    zahlungsmethode: paymentNames[paymentMethod],
                    timestamp: new Date().toISOString()
                };

                console.log('üì§ Sende Vertragsdaten:', contractData);

                const formData = new FormData();
                formData.append('data', JSON.stringify(contractData));

                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                console.log('üì• Antwort:', result);

                if (result.success) {
                    if (paymentMethod === 'stripe') {
                        // Stripe Payment initiieren
                        alert('‚úÖ Vertrag gespeichert!\n\nSie werden jetzt zur sicheren Stripe-Zahlungsseite weitergeleitet.');
                        // TODO: Stripe Checkout implementieren
                        window.location.href = `bestaetigung.html?mid=${window.contractData.mid}&payment=stripe`;
                    } else if (paymentMethod === 'invoice') {
                        alert('‚úÖ Vertrag erfolgreich abgeschlossen!\n\nSie erhalten in K√ºrze eine Rechnung per E-Mail.\n\nZahlungsziel: 14 Tage');
                        window.location.href = `bestaetigung.html?mid=${window.contractData.mid}&payment=invoice`;
                    } else if (paymentMethod === 'cash') {
                        alert('‚úÖ Vertrag erfolgreich abgeschlossen!\n\nWir kontaktieren Sie zeitnah zur Vereinbarung eines Zahlungstermins.');
                        window.location.href = `bestaetigung.html?mid=${window.contractData.mid}&payment=cash`;
                    }
                } else {
                    throw new Error(result.error || 'Unbekannter Fehler');
                }

            } catch (error) {
                console.error('‚ùå Fehler beim Speichern:', error);
                alert('‚ùå Fehler beim Speichern des Vertrags!\n\n' + error.message + '\n\nBitte versuchen Sie es erneut oder kontaktieren Sie uns: dpo@domassist.de');
                btn.disabled = false;
                btn.textContent = '‚úÖ Verbindlich bestellen';
            }
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Load contract data
            if (!loadContractData()) {
                return;
            }

            // Checkbox listeners
            ['accept-terms', 'accept-individual', 'accept-withdrawal', 'accept-privacy'].forEach(id => {
                document.getElementById(id).addEventListener('change', validateForm);
            });

            // Payment option listeners
            document.querySelectorAll('.payment-option').forEach(option => {
                option.addEventListener('click', function() {
                    selectPaymentOption(this);
                });
            });

            // Payment radio listeners (f√ºr Validierung)
            document.querySelectorAll('input[name="payment"]').forEach(radio => {
                radio.addEventListener('change', validateForm);
            });

            // Submit button
            document.getElementById('btn-submit').addEventListener('click', function() {
                submitContract();
            });

            console.log('‚úÖ Event Listeners initialisiert');
        });
    </script>
</body>
</html>
